%%%%%%%%%%%%%%%%%%%%%%% file template.tex %%%%%%%%%%%%%%%%%%%%%%%%%
%
% This is a general template file for the LaTeX package SVJour3
% for Springer journals.          Springer Heidelberg 2010/09/16
%
% Copy it to a new file with a new name and use it as the basis
% for your article. Delete % signs as needed.
%
% This template includes a few options for different layouts and
% content for various journals. Please consult a previous issue of
% your journal as needed.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% First comes an example EPS file -- just ignore it and
% proceed on the \documentclass line
% your LaTeX will extract the file if required
\begin{filecontents*}{example.eps}
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 19 19 221 221
%%CreationDate: Mon Sep 29 1997
%%Creator: programmed by hand (JK)
%%EndComments
gsave
newpath
  20 20 moveto
  20 220 lineto
  220 220 lineto
  220 20 lineto
closepath
2 setlinewidth
gsave
  .4 setgray fill
grestore
stroke
grestore
\end{filecontents*}
%
\RequirePackage{fix-cm}
%
%\documentclass{svjour3}                     % onecolumn (standard format)
%\documentclass[smallcondensed]{svjour3}     % onecolumn (ditto)
\documentclass[smallextended]{svjour3}       % onecolumn (second format)
%\documentclass[twocolumn]{svjour3}          % twocolumn
%
\smartqed  % flush right qed marks, e.g. at end of proof
%
\usepackage{graphicx}
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{verbatim}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{colortbl}
\usepackage{balance}
\usepackage{hyperref}
\usepackage[table]{xcolor}
\usepackage{subcaption}

\usepackage{dirtree}

\usepackage{natbib}
\usepackage{amssymb}

\usepackage{tikz}
\usetikzlibrary{fit,automata,positioning}
\usetikzlibrary{decorations.pathmorphing}
\tikzset{snake it/.style={decorate, decoration=snake}}
\usepackage{booktabs} % For formal tables

\usepackage{kbordermatrix} % include package @ document preamble
%
% \usepackage{mathptmx}      % use Times fonts if available on your TeX system
%
% insert here the call for the packages your document requires
%\usepackage{latexsym}
% etc.
%
% please place your own definitions here and don't use \def but
% \newcommand{}{}
\renewcommand{\kbldelim}{(} % change default array delimiters to parentheses
\renewcommand{\kbrdelim}{)}

\newlength\Origarrayrulewidth

% horizontal rule equivalent to \cline but with 2pt width
\newcommand{\Cline}[1]{%
	\noalign{\global\setlength\Origarrayrulewidth{\arrayrulewidth}}%
	\noalign{\global\setlength\arrayrulewidth{3pt}}\cline{#1}%
	\noalign{\global\setlength\arrayrulewidth{\Origarrayrulewidth}}%
}

% draw a vertical rule of width 2pt on both sides of a cell
\newcommand\Thickvrule[1]{%
	\multicolumn{1}{!{\vrule width 2pt}c!{\vrule width 2pt}}{#1}%
}

% draw a vertical rule of width 2pt on the left side of a cell
\newcommand\Thickvrulel[1]{%
	\multicolumn{1}{!{\vrule width 2pt}c}{#1}%
}

% draw a vertical rule of width 2pt on the right side of a cell
\newcommand\Thickvruler[1]{%
	\multicolumn{1}{c!{\vrule width 2pt}}{#1}%
}

\newcommand\mc{\multicolumn{1}{c}{\cellcolor{lightgray}\textbf{1}}}
\newcommand{\term}[1]{\emph{#1}}
%
% Insert the name of "your journal" with
% \journalname{myjournal}
%

\algtext*{EndWhile}% Remove "end while" text
\algtext*{EndIf}% Remove "end if" text
\algtext*{EndFor}% Remove "end for" text
\algtext*{EndFunction}% Remove "end function" text

\begin{document}

\title{One Algorithm to Evaluate Them All: Unified Linear Algebra Based Approach to Evaluate Both Regular and Context-Free Path Queries%\thanks{Grants or other notes
%about the article that should go on the front page should be
%placed here. General acknowledgments should be placed at the end of the article.}
}
%\subtitle{Do you have a subtitle?\\ If so, write it here}

%\titlerunning{Short form of title}        % if too long for running head

\author{Ekaterina~Shemetova  \thanks {The research was supported by the Russian Science Foundation, grant number: 18-11-00100}       \and
        Rustam~Azimov \and
            Egor~Orachev \and
             Ilya~Epelbaum \and
             Semyon~Grigorev
}

%\authorrunning{Short form of author list} % if too long for running head

\institute{E. Shemetova \at
              Saint Petersburg State University, 7/9 Universitetskaya nab., St. Petersburg, Russia\\
              Saint Petersburg Academic University, 8/3 Khlopin St., St. Petersburg, Russia\\
              JetBrains Research, Primorskiy prospekt 68-70, Building 1, St. Petersburg, Russia\\
              \email{katyacyfra@gmail.com}           %  \\
%             \emph{Present address:} of F. Author  %  if needed
           \and
R. Azimov \at
              Saint Petersburg State University, 7/9 Universitetskaya nab., St. Petersburg, Russia\\
              JetBrains Research, Primorskiy prospekt 68-70, Building 1, St. Petersburg, Russia\\
              \email{rustam.azimov19021995@gmail.com}           %  \\
%             \emph{Present address:} of F. Author  %  if needed
           \and
E. Orachev \at
              Saint Petersburg State University, 7/9 Universitetskaya nab., St. Petersburg, Russia\\
              JetBrains Research, Primorskiy prospekt 68-70, Building 1, St. Petersburg, Russia\\
              \email{egor.orachev@gmail.com}           %  \\
%             \emph{Present address:} of F. Author  %  if needed
           \and
I. Epelbaum \at
              Saint Petersburg State University, 7/9 Universitetskaya nab., St. Petersburg, Russia\\
              JetBrains Research, Primorskiy prospekt 68-70, Building 1, St. Petersburg, Russia\\
              \email{iliyepelbaun@gmail.com}           %  \\
%             \emph{Present address:} of F. Author  %  if needed
           \and
S. Grigorev \at
              Saint Petersburg State University, 7/9 Universitetskaya nab., St. Petersburg, Russia\\
              JetBrains Research, Primorskiy prospekt 68-70, Building 1, St. Petersburg, Russia\\
              \email{s.v.grigoriev@spbu.ru, semyon.grigorev@jetbrains.com}           %  \\
%             \emph{Present address:} of F. Author  %  if needed
           \and
}

\date{Received: date / Accepted: date}
% The correct dates will be entered by the editor


\maketitle

\begin{abstract}
  The Kronecker product-based algorithm for context-free path querying (CFPQ) was proposed by \citet{10.1007/978-3-030-54832-2_6}. We reduce this algorithm to operations over Boolean matrices and extend it with the mechanism to extract all paths of interest. We also prove $O(n^3/\log{n})$ time complexity of the proposed algorithm, where $n$ is a number of vertices of the input graph. Thus, we provide the alternative way to construct a slightly subcubic algorithm for CFPQ which is based on linear algebra and incremental transitive closure
  (a classic graph-theoretic problem), as opposed to the algorithm with the same complexity proposed by~\cite{10.1145/1328438.1328460}. Our evaluation shows that our algorithm is a good candidate to be the universal algorithm for both regular and context-free path querying.
\keywords{Graph databases \and Regular path queries\and Context-free path queries \and CFL-reachability \and Dynamic transitive closure}
% \PACS{PACS code1 \and PACS code2 \and more}
% \subclass{MSC code1 \and MSC code2 \and more}
\end{abstract}


\begin{acknowledgements}
We are grateful to Ekaterina Verbitskaia for careful reading and pointing out some mistakes.
\end{acknowledgements}
\input{introduction}
\input{preliminaries}
\input{cfpq_by_kronecker_product}
\input{evaluation}
\input{related_work}
\input{conclusion}
% Authors must disclose all relationships or interests that
% could have direct or potential influence or impart bias on
% the work:
%
% \section*{Conflict of interest}
%
% The authors declare that they have no conflict of interest.


% BibTeX users please use one of
%\bibliographystyle{spbasic}      % basic style, author-year citations
%\bibliographystyle{spmpsci}      % mathematics and physical sciences
%\bibliographystyle{spphys}       % APS-like style for physics
%\bibliography{}   % name your BibTeX data base

\bibliographystyle{spbasic}
\bibliography{tensor_product_CFPQ}
\end{document}
% end of file template.tex

